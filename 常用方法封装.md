```javascript
/**
 * 获取url中的某个参数的值
 * @method getHrefVal
 * @param {string} name (必传 查找的url中的某个参数的值)
 * @param {string} url (可选)
 * @return {string}
 */
function getHrefVal(name, url) {
  const reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
  let regMatch = window.location.search.substr(1).match(reg);
  if (url) {
    let _url = url.split("?")[1];
    regMatch = _url.match(reg);
  }
  if (regMatch === null) return "";
  else return decodeURIComponent(regMatch[2]);
}
// 备注: URLSearchParams 有很大的兼容性问题
function getHrefVal(name) {
  return decodeURIComponent(new URLSearchParams(window.location.search).get(name));
}
```

```javascript
/**
 * 数字格式化 1234567890 --> 1,234,567,890
 * @method formatNumber
 * @param {string} str (必传 数字的字符串形式)
 * @param {string} joiner (可选 格式化的连接符)
 * @return {string}
 */
function formatNumber(str, joiner = ",") {
  const len = str.length;
  let arr = [],
    count = len;

  while (count >= 3) {
    arr.unshift(str.slice(count - 3, count));
    count -= 3;
  }
  // 数字长度如果不是3的倍数则追加上去
  len % 3 && arr.unshift(str.slice(0, len % 3));
  return arr.join(joiner);
}

function formatNumber(str, joiner = ",") {
  return str
    .split("")
    .reverse()
    .reduce((prev, next, index) => {
      return (index % 3 ? next : next + joiner) + prev;
    });
}
```

```javascript
/**
 * 数据类型检测
 * @method judgeType
 * @param {*} data
 */
function judgeType(data) {
  return Object.prototype.toString
    .call(data)
    .slice(8, -1)
    .toLocaleLowerCase();
}
```

```javascript
/**
 * 交换数组中两项的位置
 * @method swapArray
 * @param {Array} arr (进行操作的数组)
 * @param {number} x (位置1下标索引)
 * @param {number} y (位置2下标索引)
 * @return {Array}
 */
function swapArray(arr, x, y) {
  const swapArr = arr.concat();
  const len = arr.length;

  x < 0 && (x = len + x);
  y < 0 && (y = len + y);

  if (x < 0 || y < 0 || x > len - 1 || y > len - 1) {
    console.error("两个相互交互的位置不得大于数组长度");
    return swapArr;
  }

  if (x === y) {
    return swapArr;
  }
  // ES5 写法
  // swapArr.splice(x, 1, swapArr.splice(y, 1, swapArr[x])[0])

  // ES6 写法
  // [swapArr[x], swapArr[y]] = [swapArr[y], swapArr[x]] // 解构赋值的写法
  swapArr.splice(x, 1, ...swapArr.splice(y, 1, swapArr[x])); // 普通写法
  return swapArr;
}
```

```javascript
/**
 * 格式化时间
 * @method formatDate
 * @param {string | number} (可以被 Date.parse() 方法识别的字符串或者时间戳)
 * @return {string}
 */
function formatDate(date) {
  const date = new Date(date);
  let y = date.getFullYear();
  let m = date.getMonth() + 1;
  // m = m < 10 ? ('0'+m) : m;
  m < 10 && (m = "0" + m);
  let d = date.getDate() + 1;
  // d = d < 10 ? ('0'+d) : d;
  d < 10 && (d = "0" + d);
  let hour = date.getHours();
  hour < 10 && (hour = "0" + hour);
  let min = date.getMinutes();
  min < 10 && (min = "0" + min);
  let sec = date.getSeconds();
  sec < 10 && (sec = "0" + sec);
  return y + "-" + m + "-" + d + " " + hour + ":" + min + ":" + sec;
}
```

```javascript
/**
 * 数据筛选
 * 根据一个对象中的多条件来筛选出数组中符合条件的多个数据
 * @method multiFilter
 * @param {Array} originalArr (被用来筛选的原始数组)
 * @param {Object} filtersObj ()
 * @return {Array}
 */
function multiFilter(originalArr, filtersObj) {
  const filterKeys = Object.keys(filtersObj);
  return originalArr.filter(item => {
    return filterKeys.every(key => {
      if (!filtersObj[key].length) return true;
      return !!~filtersObj[key].indexOf(item[key]);
    });
  });
}
const originalArr = [
  { name: "Anne", age: 23, gender: "female" },
  { name: "Leila", age: 16, gender: "female" },
  { name: "Jay", age: 19, gender: "male" },
  { name: "Mark", age: 40, gender: "male" }
];
const filtersObj = {
  name: ["Leila", "Jay"],
  age: [19, 23]
};
// resArr: {name: "Jay", age: 19, gender: "male"}
const resArr = multiFilter(originalArr, filtersObj);
```

```javascript
/**
 * 判断当前设备类型
*/
function os() {
  var ua = navigator.userAgent,
    isWindowsPhone = /(?:Windows Phone)/.test(ua),
    isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,
    isAndroid = /(?:Android)/.test(ua),
    isFireFox = /(?:Firefox)/.test(ua),
    isChrome = /(?:Chrome|CriOS)/.test(ua),
    isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)),
    isiPhone = /(?:iPhone)/.test(ua) && !isTablet,
    isPc = !isiPhone && !isAndroid && !isSymbian;
  return {
    isTablet: isTablet,
    isiPhone: isiPhone,
    isAndroid: isAndroid,
    isPc: isPc
  };
}
if (os.isAndroid || os.isiPhone) {
  window.location.href = '../phone/index.html'
} else if (os.isTablet) {
  // 屏幕宽度过小的平板(如ipad)同样展示手机端页面
  if (window.screen.availWidth < 960) {
      window.location.href = '../phone/index.html'
  }
}
```

```javascript
/**
 * 原生 ajax 请求
*/
document.addEventListener('DOMContentLoaded', function () {
  let AjaxGet = new XMLHttpRequest();
  AjaxGet.onreadystatechange = function () {
    if (AjaxGet.readyState === 4) {
      if ((AjaxGet.status >= 200 && AjaxGet.status < 300) || AjaxGet.status === 304) {
        let resultData = JSON.parse(AjaxGet.responseText);
        if (resultData.code === 0) {
          console.error('参数传递错误 ')
          return;
        }
        if (resultData.resultInfo) {
          // do somethings
        }

      } else {
        console.log('request was fail: ', AjaxGet.status)
      }
    }
  }
  AjaxGet.open('get', `${window.location.origin}/api/...`, true)
  AjaxGet.send(null)

})
```

```javascript
/**
 * 对 html 字符转义
 * @param {string} html 
 * @return {string}
 */
function htmlEncode(html: string): string {
  //1.首先动态创建一个容器标签元素，如DIV
  let temp = document.createElement ("div");
  //2.然后将要转换的字符串设置为这个元素的innerText(ie支持)或者textContent(火狐，google支持)
  (temp.textContent != undefined ) ? (temp.textContent = html) : (temp.innerText = html);
  //3.最后返回这个元素的innerHTML，即得到经过HTML编码转换的字符串了
  let output = temp.innerHTML;
  temp = null;
  return output;
}
```

```javascript
/**
 * 对 html 字符反转义
 * @param {string} text 
 * @return {string} 
 */
function htmlDecode(text:string): string {
  //1.首先动态创建一个容器标签元素，如DIV
  let temp = document.createElement("div");
  //2.然后将要转换的字符串设置为这个元素的innerHTML(ie，火狐，google都支持)
  temp.innerHTML = text;
  //3.最后返回这个元素的innerText(ie支持)或者textContent(火狐，google支持)，即得到经过HTML解码的字符串了。
  let output = temp.innerText || temp.textContent;
  temp = null;
  return output;
}
```

```javascript
/**
 * 计算数组中不同值出现的次数
 * @param {Array} arr 
 * @return {Array} 
 */
function arrayCount(arr) {
  let coachInfoNum = [];
  for (let i = 0; i < arr.length;) {
    let count = 0;
    for (let j = i; j < arr.length; j++) {
      if (arr[i] === arr[j]) {
        count++;
      }
    }
    coachInfoNum.push({
      date: arr[i],
      count: count
    })
    i += count;
  }
  return coachInfoNum;
}
```

```javascript
/**
 * 根据一个形如 '2018-10-10' 的字符串计算年龄
 * @param {string} dateString 
 * @return {number} 
 */
function getAge(dateString) {
  const today = new Date(), birthDate = new Date(dateString);
  let age = today.getFullYear() - birthDate.getFullYear();
  let m = today.getMonth() - birthDate.getMonth();
  if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
      age--;
  }
  return age;
}
```