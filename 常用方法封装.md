```javascript
/**
 * 获取url中的某个参数的值
 * @method getHrefVal
 * @param {string} name (必传 查找的url中的某个参数的值)
 * @param {string} url (可选)
 * @return {string}
 */
function getHrefVal(name, url) {
  const reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
  let regMatch = window.location.search.substr(1).match(reg);
  if (url !== undefined) {
    let _url = url.split("?")[1];
    regMatch = _url.match(reg);
  }
  return regMatch === null ? '' : decodeURIComponent(regMatch[2]);
}
// 备注: URLSearchParams 有很大的兼容性问题
function getHrefVal(name) {
  return decodeURIComponent(new URLSearchParams(window.location.search).get(name));
}
```

``` javascript
/**
 * 为url链接增加一个参数
 * @param {string} key (必传 要添加的参数的key)
 * @param {string} val (必传 要添加的参数的value)
 * @param {string} url (可选)
 */
function addURLParam(key, val, url = window.location.href) {
  return (url += (url.indexOf("?") === -1 ? "?" : "&") + encodeURIComponent(key) + '=' + encodeURIComponent(val));
}
```

```javascript
/**
 * 数字格式化 1234567890 --> 1,234,567,890
 * @method formatNumber
 * @param {string} str (必传 数字的字符串形式)
 * @param {string} joiner (可选 格式化的连接符)
 * @return {string}
 */
function formatNumber(str, joiner = ",") {
  const len = str.length;
  let arr = [],
    count = len;

  while (count >= 3) {
    arr.unshift(str.slice(count - 3, count));
    count -= 3;
  }
  // 数字长度如果不是3的倍数则追加上去
  len % 3 && arr.unshift(str.slice(0, len % 3));
  return arr.join(joiner);
}

function formatNumber(str, joiner = ",") {
  return str
    .split("")
    .reverse()
    .reduce((prev, next, index) => {
      return (index % 3 ? next : next + joiner) + prev;
    });
}
```

```javascript
/**
 * 数据类型检测
 * @method judgeType
 * @param {*} data
 */
function judgeType(data) {
  return Object.prototype.toString
    .call(data)
    .slice(8, -1)
    .toLocaleLowerCase();
}
```

```javascript
/**
 * 交换数组中两项的位置
 * @method swapArray
 * @param {Array} arr (进行操作的数组)
 * @param {number} x (位置1下标索引)
 * @param {number} y (位置2下标索引)
 * @return {Array}
 */
function swapArray(arr, x, y) {
  const swapArr = arr.concat();
  const len = arr.length;

  x < 0 && (x = len + x);
  y < 0 && (y = len + y);

  if (x < 0 || y < 0 || x > len - 1 || y > len - 1) {
    console.error("两个相互交互的位置不得大于数组长度");
    return swapArr;
  }

  if (x === y) {
    return swapArr;
  }
  // ES5 写法
  // swapArr.splice(x, 1, swapArr.splice(y, 1, swapArr[x])[0])

  // ES6 写法
  // [swapArr[x], swapArr[y]] = [swapArr[y], swapArr[x]] // 解构赋值的写法
  swapArr.splice(x, 1, ...swapArr.splice(y, 1, swapArr[x])); // 普通写法
  return swapArr;
}
```

```javascript
/**
 * 格式化时间
 * @method formatDate
 * @param {string | number} (可以被 Date.parse() 方法识别的字符串或者时间戳)
 * @return {string}
 */
function formatDate(date) {
  const date = new Date(date);
  let y = date.getFullYear();
  let m = date.getMonth() + 1;
  // m = m < 10 ? ('0'+m) : m;
  m < 10 && (m = "0" + m);
  let d = date.getDate() + 1;
  // d = d < 10 ? ('0'+d) : d;
  d < 10 && (d = "0" + d);
  let hour = date.getHours();
  hour < 10 && (hour = "0" + hour);
  let min = date.getMinutes();
  min < 10 && (min = "0" + min);
  let sec = date.getSeconds();
  sec < 10 && (sec = "0" + sec);
  return y + "-" + m + "-" + d + " " + hour + ":" + min + ":" + sec;
}
```

```javascript
/**
 * 数据筛选
 * 根据一个对象中的多条件来筛选出数组中符合条件的多个数据
 * @method multiFilter
 * @param {Array} originalArr (被用来筛选的原始数组)
 * @param {Object} filtersObj ()
 * @return {Array}
 */
function multiFilter(originalArr, filtersObj) {
  const filterKeys = Object.keys(filtersObj);
  return originalArr.filter(item => {
    return filterKeys.every(key => {
      if (!filtersObj[key].length) return true;
      return !!~filtersObj[key].indexOf(item[key]);
    });
  });
}
const originalArr = [
  { name: "Anne", age: 23, gender: "female" },
  { name: "Leila", age: 16, gender: "female" },
  { name: "Jay", age: 19, gender: "male" },
  { name: "Mark", age: 40, gender: "male" }
];
const filtersObj = {
  name: ["Leila", "Jay"],
  age: [19, 23]
};
// resArr: {name: "Jay", age: 19, gender: "male"}
const resArr = multiFilter(originalArr, filtersObj);
```

```javascript
/**
 * 判断当前设备类型
 * @method os
*/
function os() {
  var ua = navigator.userAgent,
    isWindowsPhone = /(?:Windows Phone)/.test(ua),
    isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,
    isAndroid = /(?:Android)/.test(ua),
    isFireFox = /(?:Firefox)/.test(ua),
    isChrome = /(?:Chrome|CriOS)/.test(ua),
    isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)),
    isiPhone = /(?:iPhone)/.test(ua) && !isTablet,
    isPc = !isiPhone && !isAndroid && !isSymbian;
  return {
    isTablet: isTablet,
    isiPhone: isiPhone,
    isAndroid: isAndroid,
    isPc: isPc
  };
}
if (os.isAndroid || os.isiPhone) {
  window.location.href = '../phone/index.html'
} else if (os.isTablet) {
  // 屏幕宽度过小的平板(如ipad)同样展示手机端页面
  if (window.screen.availWidth < 960) {
      window.location.href = '../phone/index.html'
  }
}
```

```javascript
/**
 * 原生 ajax 请求
*/
document.addEventListener('DOMContentLoaded', function () {
  let AjaxGet = new XMLHttpRequest();
  AjaxGet.onreadystatechange = function () {
    if (AjaxGet.readyState === 4) {
      if ((AjaxGet.status >= 200 && AjaxGet.status < 300) || AjaxGet.status === 304) {
        let resultData = JSON.parse(AjaxGet.responseText);
        if (resultData.code === 0) {
          console.error('参数传递错误 ')
          return;
        }
        if (resultData.resultInfo) {
          // do somethings
        }

      } else {
        console.log('request was fail: ', AjaxGet.status)
      }
    }
  }
  AjaxGet.open('get', `${window.location.origin}/api/...`, true)
  AjaxGet.send(null)

})
```

```javascript
/**
 * 对 html 字符转义
 * @method htmlEncode
 * @param {string} html 
 * @return {string}
 */
function htmlEncode(html) {
  //1.首先动态创建一个容器标签元素，如DIV
  let temp = document.createElement ("div");
  //2.然后将要转换的字符串设置为这个元素的innerText(ie支持)或者textContent(火狐，google支持)
  (temp.textContent != undefined ) ? (temp.textContent = html) : (temp.innerText = html);
  //3.最后返回这个元素的innerHTML，即得到经过HTML编码转换的字符串了
  let output = temp.innerHTML;
  temp = null;
  return output;
}
```

```javascript
/**
 * 对 html 字符反转义
 * @method htmlDecode
 * @param {string} text 
 * @return {string} 
 */
function htmlDecode(text) {
  //1.首先动态创建一个容器标签元素，如DIV
  let temp = document.createElement("div");
  //2.然后将要转换的字符串设置为这个元素的innerHTML(ie，火狐，google都支持)
  temp.innerHTML = text;
  //3.最后返回这个元素的innerText(ie支持)或者textContent(火狐，google支持)，即得到经过HTML解码的字符串了。
  let output = temp.innerText || temp.textContent;
  temp = null;
  return output;
}
```

```javascript
/**
 * 计算数组中不同值出现的次数
 * @method arrayCount
 * @param {Array} arr 
 * @return {Array} 
 */
function arrayCount(arr) {
  let coachInfoNum = [];
  for (let i = 0; i < arr.length;) {
    let count = 0;
    for (let j = i; j < arr.length; j++) {
      if (arr[i] === arr[j]) {
        count++;
      }
    }
    coachInfoNum.push({
      date: arr[i],
      count: count
    })
    i += count;
  }
  return coachInfoNum;
}
```

```javascript
/**
 * 根据一个形如 '2018-10-10' 的字符串计算年龄
 * @method getAge
 * @param {string} dateString 
 * @return {number} 
 */
function getAge(dateString) {
  const today = new Date(), birthDate = new Date(dateString);
  let age = today.getFullYear() - birthDate.getFullYear();
  let m = today.getMonth() - birthDate.getMonth();
  if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
      age--;
  }
  return age;
}
```

```javascript
/**
 * 判断页面是否是在微信中打开
 * @method isWeixin
 * @return {boolen}
 */
function isWeixin() {
  return window.top.navigator.userAgent.toLowerCase().indexOf('micromessenger') !== -1
}
```

``` javascript
/**
 * 移动端页面跳转到app
*/
function gotoApp() {
  var angent = window.top.navigator.userAgent.toLowerCase();
  var isAndroid = angent.indexOf('android') > -1 || angent.indexOf('linux') > -1;
  var isiOS = !!angent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/i);
  // Android和ios开发者定义的一个app标示
  const appHref = "yioksnike://course";
  // 如果手机上有这个app的话就将打开并跳转到相应的app页面；因为页面跳转了，所以下面的代码将不再执行
  window.location.href = appHref
  // 如果没有的话，
  setTimeout(function () {
    // Android前往下载页（或根据业务进行具体操作）
    isAndroid && (window.location.href = "load.html");
    // ios 前往appstore中app的相应页面
    isiOS && (window.location.href = 'app_store_url')
  }, 1500);
};
```